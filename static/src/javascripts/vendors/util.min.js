define(function(e,t,n){function f(e,t){t=t||"string";if(typeof t!="string")throw new Error("type must be string");return Object.prototype.toString.call(e).slice(8,-1).toLowerCase()===t.toLowerCase()}var r,i=e("jquery"),s=e("underscore"),o=[40,60,80,100,120,160,180,200,240,250,300,310,320,360,400,460,600],u=new Array("Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Spt","Oct","Nov","Dec"),a=304;r={},r.TPL={templates:{},loadTemplates:function(e,t){var n,r,s;f(e,"string")&&(e=[e]);if(!f(e,"array"))throw new Error("templateName must be array or string");n=this,r=e.length,s=function(o){var u=e[o];n.templates[u]===undefined?i.get("./static/src/javascripts/tpls/"+u+".html",function(e){n.templates[u]=e,++o<r?s(o):t()}):++o<r?s(o):t()},s(0)},get:function(e){return this.templates[e]}},r.WaterFall=function(e){this.col=e,this.water=[],this.init()},r.WaterFall.prototype.init=function(){var e,t=this.col;for(e=0;e<t;e++)this.water[e]=0},r.WaterFall.prototype.getMinIndex=function(){return s.indexOf(this.water,s.min(this.water))},r.WaterFall.prototype.getMaxIndex=function(){return s.indexOf(this.water,s.max(this.water))},r.WaterFall.prototype.pushItem=function(e){var t=this;return t.water[t.getMinIndex()]+=e,t.water},r.WaterFall.prototype.getParam=function(){return{col:this.col,water:this.water}},r.WaterFall.prototype.makeColHtml=function(){var e,t,n="";for(e=0;e<this.col;e++)t="waterCol",e===0?t+=" firstCol":e===this.col-1&&(t+=" lastedCol"),n+='<div class="'+t+'"></div>';return n},r.Date={getEnglishMonth:function(e){return u[e]},getDate:function(e,t){var n;return e=e||"/",t=t||0,n=(new Date).getTime(),n=new Date(n+t*24*60*60*1e3),n.getFullYear()+e+(1+n.getMonth())+e+n.getDate()},translateIOSDate:function(e){return e.substr(0,e.indexOf("T")).split("-").join("/")}},r.TRANSFORM={translate3d:function(e,t,n){var r;e=i(e),n=n||0,t=i.extend({x:0,y:0,z:0},t),r=e[0].style;if(!r)return;r.MozTransitionDuration=r.msTransitionDuration=r.OTransitionDuration=r.transitionDuration=n+"ms",r.webkitTransform="translate("+t.x+"px,"+t.y+"px)"+"translateZ("+t.z+"px)",r.msTransform=r.MozTransform=r.OTransform="translate("+t.x+"px,"+t.y+"px)"+"translateZ("+t.z+"px)"},autoWidth:function(e,t,n,r){var s,o,u,a;$jq=i(e),s=0,n=n||!1,r=r||0,o=$jq.parent().width(),console.log(o),(typeof t=="undefined"?t="li":t=t)&&typeof t=="string"?(u=$jq.find(t),a=u.length,a&&u.each(function(e){var t=i(this);n&&(++e===a?t.css({"float":"left",width:o+"px"}):t.css({"float":"left","margin-right":r+"px",width:o+"px"})),s+=t.outerWidth()})):typeof t=="number"&&(s=o*t),$jq.width(s)},animateBase:function(e,t){var n={direct:"h",space:5,slideP:5,rangeP:100,marginR:0,subElement:"li",isLimit:!0,cbfList:{start:i.noop,moving:i.noop,end:i.noop}};t.cbfList&&!s.isEmpty(t.cbfList)&&(i.extend(n.cbfList,t.cbfList),delete t.cbfList),i.extend(n,t),this.defaultOptions=n,this.jq=i(e),this.startPage={x:0,y:0},this.deltaPage={x:0,y:0},this.endPage={x:0,y:0},this.isMouseDown=!1,this.rangeStartX=0,this.rangeEndX=0,this.oneSlide=0,this.init()}},r.TRANSFORM.animateBase.prototype={init:function(){this.jq.wrapAll('<div class="animateWrap" style="width:100%;overflow: hidden;"></div>'),this.wrapObj=this.jq.parent(".animateWrap"),this.targetObj=this.jq.find(this.defaultOptions.subElement),this.defaultOptions.isLimit?(this.oneSlide=this.wrapObj.width(),this.rangeEndX=this.oneSlide*(this.targetObj.length-1)):(this.oneSlide=i(this.targetObj[0]).outerWidth(),this.rangeEndX=this.jq.width()-this.wrapObj.width()),this.rangeStartX=this.defaultOptions.rangeP,this.initEvent()},initEvent:function(){var e=this;e.wrapObj.on("vmousedown vmousemove vmouseout vmouseup",this.defaultOptions.subElement,function(t){var n=i(this);switch(t.type){case"vmousedown":e.startMove(t,n);break;case"vmousemove":return e.moving(t,n),!1;case"vmouseout":case"vmousedown":return e.endMove(t,n),!1}})},startMove:function(e,t){this.startPage={x:e.pageX,y:e.pageY},this.deltaPage={x:0,y:0},this.isMouseDown=!0,this.defaultOptions.cbfList.start(t)},moving:function(e,t){var n;if(!this.isMouseDown)return!1;this.deltaPage={x:e.pageX-this.startPage.x,y:e.pageY-this.startPage.y},n=this.endPage.x+this.deltaPage.x,this.endPage.x===0&&this.deltaPage.x>this.rangeStartX?this.deltaPage.x=n=this.rangeStartX:this.endPage.x===-this.rangeEndX&&this.deltaPage.x<-this.rangeStartX&&(n=this.endPage.x-this.rangeStartX,this.deltaPage.x=-this.rangeStartX),r.TRANSFORM.translate3d(this.jq,{x:n}),this.defaultOptions.cbfList.moving(t)},endMove:function(e,t){var n,i,s,o=this;this.defaultOptions.isLimit?(n=this.deltaPage.x,i=this.deltaPage.y,s=this.defaultOptions.slideP,n>0?n<this.oneSlide*s?n=this.endPage.x=n:n=this.endPage.x=this.endPage.x+this.oneSlide:n>-(this.oneSlide*s)?n=this.endPage.x=n:n=this.endPage.x=this.endPage.x-this.oneSlide,r.TRANSFORM.translate3d(this.jq,{x:n},500)):(this.endPage.x+=this.deltaPage.x,this.endPage.x>=0?(this.endPage.x=0,r.TRANSFORM.translate3d(this.jq,{x:0},500)):this.endPage.x<=-o.rangeEndX&&(this.endPage.x=-o.rangeEndX,r.TRANSFORM.translate3d(this.jq,{x:-o.rangeEndX},500))),this.defaultOptions.cbfList.end(t),this.startPage={x:0,y:0},this.isMouseDown=!1}},r.LOAD={show:function(){i("#gloabLoading").stop(!0,!0).fadeIn()},hide:function(){i("#gloabLoading").stop(!0,!0).fadeOut()}},r.getWaterFalColWidth=function(){return a},r.setWaterFalColWidth=function(e){a=e},r.OS={detect:function(e){var t=this.os={},n=this.browser={},r=e.match(/WebKit\/([\d.]+)/),i=e.match(/(Android)\s+([\d.]+)/),s=e.match(/(iPad).*OS\s([\d_]+)/),o=!s&&e.match(/(iPhone\sOS)\s([\d_]+)/),u=e.match(/(webOS|hpwOS)[\s\/]([\d.]+)/),a=u&&e.match(/TouchPad/),f=e.match(/Kindle\/([\d.]+)/),l=e.match(/Silk\/([\d._]+)/),c=e.match(/(BlackBerry).*Version\/([\d.]+)/),h=e.match(/(BB10).*Version\/([\d.]+)/),p=e.match(/(RIM\sTablet\sOS)\s([\d.]+)/),d=e.match(/PlayBook/),v=e.match(/Chrome\/([\d.]+)/)||e.match(/CriOS\/([\d.]+)/),m=e.match(/Firefox\/([\d.]+)/);if(n.webkit=!!r)n.version=r[1];return i&&(t.android=!0,t.version=i[2]),o&&(t.ios=t.iphone=!0,t.version=o[2].replace(/_/g,".")),s&&(t.ios=t.ipad=!0,t.version=s[2].replace(/_/g,".")),u&&(t.webos=!0,t.version=u[2]),a&&(t.touchpad=!0),c&&(t.blackberry=!0,t.version=c[2]),h&&(t.bb10=!0,t.version=h[2]),p&&(t.rimtabletos=!0,t.version=p[2]),d&&(n.playbook=!0),f&&(t.kindle=!0,t.version=f[1]),l&&(n.silk=!0,n.version=l[1]),!l&&t.android&&e.match(/Kindle Fire/)&&(n.silk=!0),v&&(n.chrome=!0,n.version=v[1]),m&&(n.firefox=!0,n.version=m[1]),t.tablet=!!(s||d||i&&!e.match(/Mobile/)||m&&e.match(/Tablet/)),t.phone=!t.tablet&&!!(i||o||u||c||h||v&&e.match(/Android/)||v&&e.match(/CriOS\/([\d.]+)/)||m&&e.match(/Mobile/)),{os:t,browser:n}},oldAndroid:function(){var e=r.OS.detect(navigator.userAgent),t=!1;return e.os.android&&parseInt(e.os.version.slice(0,1))<3&&(t=!0),t}},r.URL={getHash:function(){var e=window.location.hash,t="";return e&&(t=e.slice(1),t=t.split("/")),t}},r.TOOL={getPicSize:function(){var e,t,n=r.getWaterFalColWidth(),i=o[0];for(e=1,t=o.length;e<t;e++)if(n<=o[e]){i=o[e];break}return i}},n.exports=r})