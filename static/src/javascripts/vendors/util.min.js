define(function(e,t,n){function i(e,t){if(t=t||"string","string"!=typeof t)throw Error("type must be string");return Object.prototype.toString.call(e).slice(8,-1).toLowerCase()===t.toLowerCase()}var r=e("jquery"),a=e("underscore"),s=[40,60,80,100,120,160,180,200,240,250,300,310,320,360,400,460,600],o=Array("Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Spt","Oct","Nov","Dec"),l=304,c={};c.TPL={templates:{},loadTemplates:function(e,t){if(i(e,"string")&&(e=[e]),!i(e,"array"))throw Error("templateName must be array or string");var n=this,a=e.length,s=function(i){var o=e[i];void 0===n.templates[o]?r.get("./static/src/javascripts/tpls/"+o+".html",function(e){n.templates[o]=e,a>++i?s(i):t()}):a>++i?s(i):t()};s(0)},get:function(e){return this.templates[e]}},c.WaterFall=function(e){this.col=e,this.water=[],this.init()},c.WaterFall.prototype.init=function(){for(var e=this.col,t=0;e>t;t++)this.water[t]=0},c.WaterFall.prototype.getMinIndex=function(){return a.indexOf(this.water,a.min(this.water))},c.WaterFall.prototype.getMaxIndex=function(){return a.indexOf(this.water,a.max(this.water))},c.WaterFall.prototype.pushItem=function(e){var t=this;return t.water[t.getMinIndex()]+=e,t.water},c.WaterFall.prototype.getParam=function(){return{col:this.col,water:this.water}},c.WaterFall.prototype.makeColHtml=function(){for(var e="",t=0;this.col>t;t++){var n="waterCol";0===t?n+=" firstCol":t===this.col-1&&(n+=" lastedCol"),e+='<div class="'+n+'"></div>'}return e},c.Date={getEnglishMonth:function(e){return o[e]},getDate:function(e,t){e=e||"/",t=t||0;var n=(new Date).getTime();return n=new Date(n+1e3*60*60*24*t),n.getFullYear()+e+(1+n.getMonth())+e+n.getDate()},translateIOSDate:function(e){return e.substr(0,e.indexOf("T")).split("-").join("/")}},c.TRANSFORM={translate3d:function(e,t,n){e=r(e),n=n||0,t=r.extend({x:0,y:0,z:0},t);var i=e[0].style;i&&(i.MozTransitionDuration=i.msTransitionDuration=i.OTransitionDuration=i.transitionDuration=n+"ms",i.webkitTransform="translate("+t.x+"px,"+t.y+"px)"+"translateZ("+t.z+"px)",i.msTransform=i.MozTransform=i.OTransform="translate("+t.x+"px,"+t.y+"px)"+"translateZ("+t.z+"px)")}},c.LOAD={show:function(){r("#gloabLoading").stop(!0,!0).fadeIn()},hide:function(){r("#gloabLoading").stop(!0,!0).fadeOut()}},c.getWaterFalColWidth=function(){return l},c.setWaterFalColWidth=function(e){l=e},c.OS={detect:function(e){var t=this.os={},n=this.browser={},i=e.match(/WebKit\/([\d.]+)/),r=e.match(/(Android)\s+([\d.]+)/),a=e.match(/(iPad).*OS\s([\d_]+)/),s=!a&&e.match(/(iPhone\sOS)\s([\d_]+)/),o=e.match(/(webOS|hpwOS)[\s\/]([\d.]+)/),l=o&&e.match(/TouchPad/),c=e.match(/Kindle\/([\d.]+)/),u=e.match(/Silk\/([\d._]+)/),d=e.match(/(BlackBerry).*Version\/([\d.]+)/),p=e.match(/(BB10).*Version\/([\d.]+)/),h=e.match(/(RIM\sTablet\sOS)\s([\d.]+)/),f=e.match(/PlayBook/),g=e.match(/Chrome\/([\d.]+)/)||e.match(/CriOS\/([\d.]+)/),m=e.match(/Firefox\/([\d.]+)/);return(n.webkit=!!i)&&(n.version=i[1]),r&&(t.android=!0,t.version=r[2]),s&&(t.ios=t.iphone=!0,t.version=s[2].replace(/_/g,".")),a&&(t.ios=t.ipad=!0,t.version=a[2].replace(/_/g,".")),o&&(t.webos=!0,t.version=o[2]),l&&(t.touchpad=!0),d&&(t.blackberry=!0,t.version=d[2]),p&&(t.bb10=!0,t.version=p[2]),h&&(t.rimtabletos=!0,t.version=h[2]),f&&(n.playbook=!0),c&&(t.kindle=!0,t.version=c[1]),u&&(n.silk=!0,n.version=u[1]),!u&&t.android&&e.match(/Kindle Fire/)&&(n.silk=!0),g&&(n.chrome=!0,n.version=g[1]),m&&(n.firefox=!0,n.version=m[1]),t.tablet=!!(a||f||r&&!e.match(/Mobile/)||m&&e.match(/Tablet/)),t.phone=!(t.tablet||!(r||s||o||d||p||g&&e.match(/Android/)||g&&e.match(/CriOS\/([\d.]+)/)||m&&e.match(/Mobile/))),{os:t,browser:n}},oldAndroid:function(){var e=c.OS.detect(navigator.userAgent),t=!1;return e.os.android&&3>parseInt(e.os.version.slice(0,1))&&(t=!0),t}},c.URL={getHash:function(){var e=window.location.hash,t="";return e&&(t=e.slice(1),t=t.split("/")),t}},c.TOOL={getPicSize:function(){for(var e=c.getWaterFalColWidth(),t=s[0],n=1,i=s.length;i>n;n++)if(s[n]>=e){t=s[n];break}return t}},n.exports=c});