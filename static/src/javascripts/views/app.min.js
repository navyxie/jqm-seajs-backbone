define(function(e,t,n){var i=e("jqmobile"),a=e("backbone"),o=e("./title"),r=new(e("../collections/title")),s=e("./journal"),l=e("../vendors/util");l.LOAD;var d=l.TRANSFORM,c={},h=a.View.extend({initialize:function(){var e=this;r.bind("add",this.addOneNav,this),r.bind("reset",this.addAllNav,this),e.$navContainer=i("#titleNav"),e.$pageList=i("#pageList"),e.fetchTitle()},el:"body",events:{},handlerTitle:function(){var e=this;e.$navLi=e.$navContainer.find(".navLi"),e.$navContainer.on("vclick",".navLi",function(){var t=i(this);t.hasClass("navLi")&&(e.$navLi.removeClass("selected"),t.addClass("selected"))})},render:function(){return this},addOneNav:function(e){this.$navContainer.append(new o({model:e}).render().el),d.autoWidth(this.$navContainer),c[e.get("_id")]={id:null,loaded:!1}},addAllNav:function(){var e=this;r.each(function(){e.addOneNav.apply(e,arguments)})},fetchTitle:function(){var e=this;r.fetch({success:function(t,n){new d.animateBase(e.$navContainer,{isLimit:!1}),e.handlerTitle(),e.makePageContent(n.length),d.autoWidth(e.$pageList,".pageContent",!0);var i=r.at(0).toJSON();e.initJournalModel({_id:i._id,id:"pageContent0"})},error:function(){}})},makePageContent:function(e){for(var t="",n=0;e>n;n++)t+='<li class="pageContent" id="pageContent'+n+'" index='+n+"></li>";this.$pageList.append(t)},initJournalModel:function(e){c[e._id].id||(c[e._id].id=new s({el:"#"+e.id}),c[e._id].loaded||(c[e._id].loaded=!0,c[e._id].id.fetchData({id:e._id},function(t){t&&(c[e._id].loaded=!1)})))}});n.exports=h});