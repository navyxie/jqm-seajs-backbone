define(function(e,t,n){var i=e("underscore"),r=e("backbone"),a=e("../vendors/util"),s=e("jquery"),o=(a.WaterFall,a.Date,a.LOAD),l=s(window);l.height(),s("#index").find(".header").height();var c=r.View.extend({className:"journalView",initialize:function(){var e=this;e.queryObj=i.extend({type:"index"},arguments[0].query||{})},firstLoad:function(){var e=this;e.fetchData(function(t,n){if(!t){var i=n[1];i.journal&&(e.renderTitle(i),e.renderItems(i))}})},events:{},fetchData:function(e){var t=this;o.show(),t.journalModel.fetch({data:t.queryObj,success:function(){e(null,arguments),o.hide()},error:function(){alert("获取数据失败,请检查网络"),console.log("+++++++++++++++++++"),console.log(window.appConfig.appHost),console.log(JSON.stringify(t.queryObj)),console.log(t.journalModel.url),console.log("------------------"),e({err:"获取数据失败"},arguments),o.hide()}})},refreshView:function(){var e=this;e.fetchData(function(t,n){if(!t){var i=n[1];i.journal&&(e.journalTitleObj.html(""),e.waterFallObj.html(""),e.renderTitle(i),e.renderItems(i))}})},render:function(){return this},addOne:function(e){var t=this,n=new t.itemView({model:e});s(t.waterFallObj[t.waterObj.getMinIndex()]).append(n.render().el),t.waterObj.pushItem(e.toJSON().pic_size.h)},addAll:function(){var e=this;e.itemCollection.each(function(){e.addOne.apply(e,arguments)})}});n.exports=c});